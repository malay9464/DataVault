<!DOCTYPE html>
<html>
<head>
    <title>Data Vault</title>
<!-- CSS -->
    <link rel="stylesheet" href="/static/css/upload.css">
</head>
<body>
<!-- HEADER -->
<div class="top-header">
    <span style="letter-spacing:0.3px;">Data Vault</span>

    <button class="logout-btn" onclick="logout()">
        Logout
    </button>
</div>




<!-- SIDEBAR -->
<div class="sidebar">

    <!-- FIXED TOP -->
    <div class="sidebar-top">
        <div class="category active" onclick="applyFilter('all', this)">
            <span>All Files</span><span id="allCount">0</span>
        </div>

        <div class="category" id="myUploadsTab"
             onclick="applyFilter('mine', this)"
             style="display:none;">
            <span>My Uploads</span>
        </div>

        <div class="category" onclick="applyFilter('uncat', this)">
            <span>Uncategorized</span><span id="uncatCount">0</span>
        </div>

        <hr>
        <h3>Categories</h3>
    </div>

    <!-- SCROLLABLE CATEGORY LIST -->
    <div class="sidebar-scroll" id="categoryList"></div>

    <!-- FIXED BOTTOM -->
    <div class="sidebar-bottom">
        <hr>

        <div onclick="addCategoryPrompt()" class="new-category-btn">
            + New Category
        </div>

        <div onclick="openAddUserModal()"
             class="new-category-btn"
             style="margin-top:6px;">
            + Add User
        </div>

        <div onclick="location.href='/users.html'"
             class="new-category-btn">
            Manage Users
        </div>
    </div>

</div>


<!-- MAIN -->
<div class="main">
    <div class="content-box">
        <h2>Upload New File</h2>

        <div class="select-wrapper">
            <select id="categorySelect"></select>
        </div>

        <div class="upload-box" onclick="fileInput.click()">
            Click to select file
            <div id="fileName"></div>
        </div>

        <input type="file" id="fileInput" hidden accept=".csv,.xls,.xlsx">

        <button id="uploadBtn" onclick="upload()">
            Upload <span id="uploadSpinner" class="spinner" style="display:none;"></span>
        </button>

        <h3>Uploads</h3>

        <hr style="margin:25px 0; border:none; border-top:1px solid #e5e7eb;">

        <div class="search-box" style="display:flex; gap:10px; flex-wrap:wrap;">
    <input id="searchInput" placeholder="Filename contains">

    <input id="totalMin" type="number" placeholder="Total ≥" style="width:90px">
    <input id="totalMax" type="number" placeholder="Total ≤" style="width:90px">

    <input id="dupMin" type="number" placeholder="Dup ≥" style="width:90px">
    <input id="dupMax" type="number" placeholder="Dup ≤" style="width:90px">

    <input id="dateFrom" type="date">
    <input id="dateTo" type="date">

    <button onclick="applyAdvancedSearch()">Search</button>
    <button onclick="resetSearch()">Reset</button>
</div>

        <div class="table-wrapper">
            <table id="uploadTable"></table>
        </div>

        <div class="pagination" id="pagination"></div>
    </div>
</div>



<!-- ---------- ADD USER MODAL ---------- -->
<div id="addUserModal" class="modal-overlay" style="display:none;">
    <div class="modal-box">
        <div class="modal-header">
            <h3>Add User</h3>
            <span class="modal-close" onclick="closeAddUserModal()">×</span>
        </div>

        <div class="modal-body">
            <label>Email</label>
            <input type="email" id="newUserEmail" placeholder="Enter email">

            <label>Password</label>
            <input type="password" id="newUserPassword" placeholder="Enter password">

            <label>Role</label>
            <select id="newUserRole">
                <option value="user">User</option>
                <option value="admin">Admin</option>
            </select>
        </div>

        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeAddUserModal()">Cancel</button>
            <button class="btn-primary" onclick="createUser()">Add User</button>
        </div>
    </div>
</div>
<!-- TOAST CONTAINER -->
<div id="toastContainer"></div>

<script src="/static/js/upload.js"></script>
</body>
</html>