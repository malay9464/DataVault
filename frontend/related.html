<!DOCTYPE html>
<html>
<head>
    <title>Related Records - Data Vault</title>
    <link rel="stylesheet" href="/static/css/preview.css">
    <link rel="stylesheet" href="/static/css/related.css">
</head>
<body>

<div class="container">
    <div class="card">
        
        <!-- âœ… File Context with Better Styling -->
        <div id="fileContext" class="file-context">
            <div class="file-context-content">
                <span class="file-icon">ğŸ“„</span>
                <div class="file-info">
                    <span class="file-label">Analyzing duplicates in:</span>
                    <span id="fileName" class="file-name">Loading...</span>
                </div>
            </div>
        </div>

        <!-- Header with Back Button -->
        <div class="header-row">
            <h2 class="page-title">ğŸ”— Related Records</h2>
            <button class="btn-back" onclick="goBack()">â† Back to Preview</button>
        </div>

        <!-- âœ… IMPROVED: Compact Statistics Grid -->
        <div class="stats-grid">
            <div class="stat-card stat-email">
                <div class="stat-icon">ğŸ“§</div>
                <div class="stat-content">
                    <div class="stat-primary" id="statDuplicateEmails">-</div>
                    <div class="stat-label">Email records</div>
                    <div class="stat-secondary"><span id="statEmailRecords">-</span></div>
                </div>
            </div>
            
            <div class="stat-card stat-phone">
                <div class="stat-icon">ğŸ“±</div>
                <div class="stat-content">
                    <div class="stat-primary" id="statDuplicatePhones">-</div>
                    <div class="stat-label">Phone records</div>
                    <div class="stat-secondary"><span id="statPhoneRecords">-</span></div>
                </div>
            </div>
            
            <div class="stat-card stat-both">
                <div class="stat-icon">ğŸ”—</div>
                <div class="stat-content">
                    <div class="stat-primary" id="statBoth">-</div>
                    <div class="stat-label">Merged records</div>
                    <div class="stat-secondary"><span id="statBothRecords">-</span></div>
                </div>
            </div>
        </div>

        <!-- âœ… IMPROVED: Search and Sort in One Row -->
        <div class="control-bar">
            <div class="search-section">
                <input
                    type="text"
                    id="searchValue"
                    class="search-input"
                    placeholder="ğŸ” Search by email or phone..."
                    onkeypress="if(event.key==='Enter') searchRelated()"
                >
                <button class="btn-search" onclick="searchRelated()">Search</button>
                <button class="btn-reset" onclick="resetSearch()">Reset</button>
            </div>
            
            <div class="sort-section">
                <label class="sort-label">Sort by:</label>
                <select id="sortBy" class="sort-select" onchange="handleSortChange()">
                    <option value="size-desc">Most Records First</option>
                    <option value="size-asc">Fewest Records First</option>
                    <option value="alpha">Alphabetical</option>
                </select>
            </div>
        </div>

        <!-- âœ… IMPROVED: Filter Tabs with Icons -->
        <div class="filter-tabs">
            <button id="btnFilterAll" class="filter-tab active" onclick="filterByType('all')">
                <span class="filter-icon">ğŸ“Š</span>
                <span class="filter-label">All Groups</span>
            </button>
            <button id="btnFilterEmail" class="filter-tab" onclick="filterByType('email')">
                <span class="filter-icon">ğŸ“§</span>
                <span class="filter-label">Email Only</span>
            </button>
            <button id="btnFilterPhone" class="filter-tab" onclick="filterByType('phone')">
                <span class="filter-icon">ğŸ“±</span>
                <span class="filter-label">Phone Only</span>
            </button>
            <button id="btnFilterBoth" class="filter-tab" onclick="filterByType('both')">
                <span class="filter-icon">ğŸ”—</span>
                <span class="filter-label">Both (Merged)</span>
            </button>
        </div>

        <!-- Results Container -->
        <div id="resultsContainer">
            <div class="loading-state">
                <div class="loading-spinner"></div>
                <p>Loading related records...</p>
            </div>
        </div>

        <!-- Pagination -->
        <div id="relatedPagination" class="pagination"></div>

    </div>
</div>

<script src="/static/js/related.js"></script>
</body>
</html>